var C=Object.defineProperty;var y=(i,s,e)=>s in i?C(i,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[s]=e;var a=(i,s,e)=>(y(i,typeof s!="symbol"?s+"":s,e),e);(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))t(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&t(l)}).observe(document,{childList:!0,subtree:!0});function e(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerpolicy&&(r.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?r.credentials="include":n.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function t(n){if(n.ep)return;n.ep=!0;const r=e(n);fetch(n.href,r)}})();let v=(i,s)=>{var t;let e=new TextEncoder().encode(i);return i=new TextDecoder().decode(e.slice(0,s)),((t=i.at(-1))==null?void 0:t.charCodeAt(0))===65533?i.slice(0,-1):i};class w{constructor(s){a(this,"___valueListeners",[]);a(this,"___value");a(this,"info");this.___value=s}addListener(s,e){if(this.___valueListeners.push(s),e){let t=this.get;t instanceof Promise?t.then(s):s(t)}return s}removeListener(s){let e=this.___valueListeners.indexOf(s);return e!=-1&&this.___valueListeners.splice(e,1),s}get get(){return this.___value}set set(s){this.___value!==s&&(this.___value=s,this.___update())}___update(){if(this.___valueListeners)for(let s=0,e=this.___valueListeners.length;s<e;s++)try{this.___valueListeners[s](this.___value)}catch(t){console.warn("Failed while calling value listeners ",t)}}compare(s){let e=this.get;return e instanceof Promise?e.then(t=>s!==t):s!==e}get inUse(){return this.___valueListeners.length!==0}hasListener(s){return this.___valueListeners.indexOf(s)!==-1}toJSON(){return this.___value}}class D extends w{constructor(e,t){super(e);a(this,"___limiters");a(this,"___limitersListeners",[]);this.___limiters=t}addLimiterListener(e,t){return this.___limitersListeners.push(e),t&&e(this),e}removeLimiterListener(e){let t=this.___limitersListeners.indexOf(e);return t!=-1&&this.___limitersListeners.splice(t,1),e}___updateLimiter(){if(this.___limitersListeners)for(let e=0,t=this.___limitersListeners.length;e<t;e++)try{this.___limitersListeners[e](this)}catch(n){console.warn("Failed while calling value listeners ",n)}}get limiters(){return this.___limiters}set limiters(e){e?this.___limiters=e:delete this.___limiters,this.___updateLimiter()}checkLimit(e){if(this.___limiters){for(let t=0;t<this.___limiters.length;t++)if(this.___limiters[t].func(e))return!1}return!0}checkLimitReason(e){if(this.___limiters)for(let t=0;t<this.___limiters.length;t++){let n=this.___limiters[t];if(n.func(e))if(n.correction)switch(typeof n.reason){case"string":return{allowed:!1,reason:n.reason,correction:n.correction(e)};case"function":return{allowed:!1,reason:n.reason(e),correction:n.correction(e)}}else switch(typeof n.reason){case"string":return{allowed:!1,reason:n.reason};case"function":return{allowed:!1,reason:n.reason(e)}}}return{allowed:!0,reason:""}}set set(e){e===this.___value||!this.checkLimit(e)||(this.___value=e,this.___update())}}class O extends D{constructor(e,t,n,r,l){super(e,l);a(this,"_maxLength");a(this,"_maxByteLength");a(this,"___enums");this._maxLength=n,this._maxByteLength=r,this.___enums=t}get enums(){return this.___enums}set enums(e){if(e){if(this.___enums=e,!this.checkEnum(this.___value))for(const t in this.___enums){this.___value=t,this.___update();return}}else delete this.___enums;this.___updateLimiter()}get enum(){if(this.___enums)return this.___enums[this.___value]}checkEnum(e){return!this.___enums||e in this.___enums}get maxLength(){return this._maxLength}set maxLength(e){this._maxLength=e,this._maxLength&&this.___value.length>this._maxLength&&(this.___value=this.___value.slice(0,this._maxLength),this.___update()),this.___updateLimiter()}get maxByteLength(){return this._maxByteLength}set maxByteLength(e){if(this._maxByteLength=e,this._maxByteLength){let t=v(this.___value,this._maxByteLength);this.___value!==t&&(this.___value=t,this.___update())}this.___updateLimiter()}set set(e){this._maxLength&&e.length>this._maxLength&&(e=e.slice(0,this._maxLength)),this._maxByteLength&&(e=v(e,this._maxByteLength)),e!==this.___value&&this.checkLimit(e)&&this.checkEnum(e)&&(this.___value=e,this.___update())}}var c=(i=>(i.write="w",i.read="r",i.none="n",i))(c||{});const T={w:{name:"Write",description:"Write access to element"},r:{name:"Read",description:"Read access to element"},n:{name:"None",description:"No access to element"}};class E extends O{constructor(s){super(s,T)}}class k{constructor(s,e,t){a(this,"type");a(this,"target");a(this,"data");this.type=s,this.target=e,this.data=t}}class B{constructor(){a(this,"target");a(this,"eventHandler_ListenerStorage",{})}on(s,e){let t=this.eventHandler_ListenerStorage[s];return t?t.indexOf(e)==-1?t.push(e):console.warn("Listener already in handler"):this.eventHandler_ListenerStorage[s]=[e],e}once(s,e){return this.on(s,function(t){return e(t),!0}),e}off(s,e){let t=this.eventHandler_ListenerStorage[s];if(t){let n=t.indexOf(e);n!=-1?t.splice(n,1):console.warn("Listener not in handler")}return e}emit(s,e){let t=this.eventHandler_ListenerStorage[s];if(t&&t.length>0){let n=Object.freeze(new k(s,this.target||this,e));t.length>1&&(t=[...t]);for(let r=0,l=t.length;r<l;r++)try{t[r](n)&&(t.splice(r,1),l--,r--)}catch($){console.warn("Failed while dispatching event",$)}}}clear(s){this.eventHandler_ListenerStorage[s]=[]}inUse(s){var e;return Boolean((e=this.eventHandler_ListenerStorage[s])==null?void 0:e.length)}has(s,e){var t;return Boolean(((t=this.eventHandler_ListenerStorage[s])==null?void 0:t.indexOf(e))!==-1)}amount(s){var e;return((e=this.eventHandler_ListenerStorage[s])==null?void 0:e.length)||0}get eventsUserOnly(){return this}}var u=(i=>(i[i.Connect=0]="Connect",i[i.Disconnect=1]="Disconnect",i[i.Adopted=2]="Adopted",i))(u||{});class S extends HTMLElement{constructor(...e){super();a(this,"$connectedObserver");a(this,"isVisible",!1);a(this,"events",new B);a(this,"$values");a(this,"$valueFuncs");a(this,"$valueConnector");a(this,"$access",c.write);a(this,"$accessListener");this.events.target=this}static elementName(){return"@abstract@"}static elementNameSpace(){return"chocolatelibui-core"}connectedCallback(){this.$connectedObserver?this.$connectedObserver.observe(this):(this.events.emit("connect",0),this.isVisible=!0)}disconnectedCallback(){this.$connectedObserver?(this.$connectedObserver.unobserve(this),this.isVisible&&(this.events.emit("connect",1),this.isVisible=!1)):(this.events.emit("connect",1),this.isVisible=!1)}adoptedCallback(){this.events.emit("connect",2)}options(e){return this.access=e.access,this}attachToObserver(e){e?(this.$connectedObserver=e,this.isConnected&&e.observe(this)):this.$connectedObserver&&(this.isConnected&&this.$connectedObserver.unobserve(this),this.isVisible||(this.events.emit("connect",0),this.isVisible=!0),delete this.$connectedObserver)}attachValue(e,t){if(this.$valueFuncs){if(this.$valueFuncs.includes(t))throw"Function is already attached to this element"}else this.$values=[],this.$valueFuncs=[];return this.$valueConnector?this.isVisible&&e.addListener(t):this.$valueConnector=this.events.on("connect",n=>{switch(n.data){case 0:for(let r=0;r<this.$values.length;r++)this.$values[r].addListener(this.$valueFuncs[r],!0);break;case 1:for(let r=0;r<this.$values.length;r++)this.$values[r].removeListener(this.$valueFuncs[r]);break;case 2:for(let r=0;r<this.$values.length;r++)this.$values[r].removeListener(this.$valueFuncs[r]),this.$values[r].addListener(this.$valueFuncs[r],!0)}}),this.$valueFuncs.push(t),this.$values.push(e),t}dettachValue(e){if(this.$valueFuncs){let t=this.$valueFuncs.indexOf(e);t>-1&&(this.isVisible&&this.$values[t].removeListener(e),this.$values.splice(t,1),this.$valueFuncs.splice(t,1),this.$valueFuncs.length===0&&this.events.off("connect",this.$valueConnector))}}get access(){return this.$access}set access(e){this.$accessListener&&(this.dettachValue(this.$accessListener),delete this.$accessListener),typeof e=="object"&&e instanceof E?this.$accessListener=this.attachValue(e,t=>{this.$accessChange(t),this.$access=t}):e?(this.$accessChange(e),this.$access=e):(this.$accessChange(c.write),this.$access=c.write)}$accessChange(e){switch(e){case c.write:this.inert=!1;break;case c.read:this.inert=!0;break;case c.none:this.setAttribute("inert","none");break}}}const H=new Set(["annotation-xml","color-profile","font-face","font-face-src","font-face-uri","font-face-format","font-face-name","missing-glyph"]);var N=/^[a-z](?:[\.0-9_a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*-(?:[\x2D\.0-9_a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*$/;let V=i=>i?/[A-Z]/.test(i)?"Custom element names must not contain uppercase ASCII characters.":i.includes("-")?/^\d/i.test(i)?"Custom element names must not start with a digit.":/^-/i.test(i)?"Custom element names must not start with a hyphen.":N.test(i)?H.has(i)?`The supplied element name is reserved and can't be used.
See: https://html.spec.whatwg.org/multipage/scripting.html#valid-custom-element-name`:"Unknown fault":"Invalid element name.":"Custom element names must contain a hyphen. Example: unicorn-cake":"Missing element name.",M=i=>{let s=i.elementNameSpace(),e=i.elementName,t="",n=i;for(;n!==HTMLElement&&s===n.elementNameSpace();){let r=n.elementName();if(n=Object.getPrototypeOf(n),e===n.elementName)throw new Error("Element uses same name as ancestor, abstract classes should return '@abstract@'");if(!r.length)throw new Error("Element doesn't define element name");r!=="@abstract@"&&(t="-"+r+t)}t=s+t;try{customElements.define(t,i)}catch(r){throw r.message.includes("has already been used with this registry")?r:new Error(V(t)+" "+t)}};class A extends IntersectionObserver{constructor(s){super(e=>{for(let t=0;t<e.length;t++)e[t].isIntersecting?e[t].target.isVisible||(e[t].target.events.emit("connect",u.Connect),e[t].target.isVisible=!0):e[t].target.isVisible&&(e[t].target.events.emit("connect",u.Disconnect),e[t].target.isVisible=!1)},s)}}class m extends S{constructor(e){super();a(this,"connects",0);a(this,"disconnects",0);this.style.height="2rem",this.events.on("connect",t=>{switch(t.data){case u.Connect:this.connects++,this.style.backgroundColor="green",console.log("test1");break;case u.Disconnect:this.disconnects++,this.style.backgroundColor="red",console.log("test2");break}this.innerHTML=`Test Element ${e} Connects:${this.connects} Disconnects${this.disconnects}`})}static elementName(){return"testclass"}options(e){return this}}M(m);let f=document.body.appendChild(document.createElement("div")),I=f.appendChild(document.createElement("div"));I.innerHTML="Test Connecting";let p=f.appendChild(document.createElement("button"));p.innerHTML="Toggle Connect";p.onclick=()=>{o.children.length===0?L.forEach(i=>{o.appendChild(i)}):o.replaceChildren()};let o=f.appendChild(document.createElement("div"));o.style.display="flex";o.style.flexDirection="column";let L=[];for(let i=0;i<=19;i++){let s=new m(String(i));o.appendChild(s),L[i]=s}let _=document.body.appendChild(document.createElement("div")),P=_.appendChild(document.createElement("div"));P.innerHTML="Test Observer";let b=_.appendChild(document.createElement("button"));b.innerHTML="Toggle Observer";let d=!0;b.onclick=()=>{g.forEach(i=>{i.attachToObserver(d?void 0:x)}),d=!d};let F=_.appendChild(document.createElement("button"));F.innerHTML="Toggle Connect";F.onclick=()=>{h.children.length===0?g.forEach(i=>{h.appendChild(i)}):h.replaceChildren()};let h=_.appendChild(document.createElement("div"));h.style.display="flex";h.style.flexDirection="column";let x=new A({threshold:1}),g=[];for(let i=0;i<=99;i++){let s=new m(String(i));s.attachToObserver(x),h.appendChild(s),g[i]=s}
