(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function t(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerpolicy&&(r.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?r.credentials="include":n.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=t(n);fetch(n.href,r)}})();class L{constructor(){this._subscribers=[]}subscribe(e,t){if(this._subscribers.push(e),t)try{this.then(e)}catch{console.warn("Failed while calling update function",this,e)}return e}unsubscribe(e){const t=this._subscribers.indexOf(e);return t!=-1?this._subscribers.splice(t,1):console.warn("Subscriber not found with state",this,e),e}inUse(){return Boolean(this._subscribers.length)}hasSubscriber(e){return this._subscribers.includes(e)}_updateSubscribers(e){for(let t=0,s=this._subscribers.length;t<s;t++)try{this._subscribers[t](e)}catch(n){console.warn("Failed while calling subscribers ",n,this,this._subscribers[t])}}}class p extends L{constructor(e,t,s,n){super(),t&&(this._setter=t===!0?this.set:t),s&&(this._check=s),n&&(this._limit=n),this._value=e}async then(e){return await e(this._value)}write(e){this._setter&&this._value!==e&&this._setter(e,this)}check(e){return this._check?this._check(e):void 0}limit(e){return this._limit?this._limit(e):e}set(e){this._value=e,this._updateSubscribers(e)}}var o=(i=>(i.write="w",i.read="r",i.none="n",i))(o||{});class E{constructor(e,t,s){this.type=e,this.target=t,this.data=s}}class O{constructor(e){this.eventHandler_ListenerStorage={},this.target=e}on(e,t){let s=this.eventHandler_ListenerStorage[e];return s?s.indexOf(t)==-1?s.push(t):console.warn("Subscriber already in handler"):this.eventHandler_ListenerStorage[e]=[t],t}once(e,t){return this.on(e,function(s){return t(s),!0}),t}off(e,t){let s=this.eventHandler_ListenerStorage[e];if(s){let n=s.indexOf(t);n!=-1?s.splice(n,1):console.warn("Subscriber not in handler")}return t}emit(e,t){let s=this.eventHandler_ListenerStorage[e];if(s&&s.length>0){let n=Object.freeze(new E(e,this.target,t));s.length>1&&(s=[...s]);for(let r=0,c=s.length;r<c;r++)try{s[r](n)===!0&&(s.splice(r,1),c--,r--)}catch(D){console.warn("Failed while dispatching event",D)}}}clear(e){this.eventHandler_ListenerStorage[e]=[]}inUse(e){var t;return Boolean((t=this.eventHandler_ListenerStorage[e])==null?void 0:t.length)}has(e,t){var s;return Boolean(((s=this.eventHandler_ListenerStorage[e])==null?void 0:s.indexOf(t))!==-1)}amount(e){var t;return((t=this.eventHandler_ListenerStorage[e])==null?void 0:t.length)||0}}const k=i=>{let e=new O(i);return e.target=i,{producer:e,consumer:e}};var b=(i=>(i[i.Connect=0]="Connect",i[i.Disconnect=1]="Disconnect",i[i.Adopted=2]="Adopted",i))(b||{});class v extends HTMLElement{constructor(...e){super(),this.isVisible=!1;let t=k(this);this._events=t.producer,this.events=t.consumer}static elementName(){return"@abstract@"}static elementNameSpace(){return"chocolatelibui-core"}connectedCallback(){if(this._events.emit("connect",0),this._connectStates&&this._connectSubscribers)for(let e=0;e<this._connectStates.length;e++)this._connectStates[e].subscribe(this._connectSubscribers[e],!0);this._observer?this._observer.observe(this):this._setVisible(!0)}disconnectedCallback(){if(this._events.emit("connect",1),this._connectStates&&this._connectSubscribers)for(let e=0;e<this._connectStates.length;e++)this._connectStates[e].unsubscribe(this._connectSubscribers[e]);this._observer&&(this._observer.unobserve(this),this._setVisible(!1))}adoptedCallback(){this._events.emit("connect",2)}_setVisible(e){if(this.isVisible!==e){if(this.isVisible=e,this._events.emit("visible",e),e){if(this._visibleStates&&this._visibleSubscribers)for(let t=0;t<this._visibleStates.length;t++)this._visibleStates[t].subscribe(this._visibleSubscribers[t],!0)}else if(this._visibleStates&&this._visibleSubscribers)for(let t=0;t<this._visibleStates.length;t++)this._visibleStates[t].unsubscribe(this._visibleSubscribers[t])}}options(e){return this.access=e.access,this}attachToObserver(e){e?(this.isConnected&&(this._observer&&this._observer.unobserve(this),e.observe(this)),this._observer=e):this._observer&&(this.isConnected&&this._observer.unobserve(this),this.isVisible||this._setVisible(!0),this._observer=void 0)}attachState(e,t,s){return s?(this._visibleStates||(this._visibleStates=[],this._visibleSubscribers=[]),this._visibleStates.push(e),this._visibleSubscribers.push(t),this.isVisible&&e.subscribe(t,!0),t):(this._connectStates||(this._connectStates=[],this._connectSubscribers=[]),this._connectStates.push(e),this._connectSubscribers.push(t),this.isConnected&&e.subscribe(t,!0),t)}dettachState(e,t){if(t){if(this._visibleSubscribers){let s=this._visibleSubscribers.indexOf(e);s===-1?console.warn("Function not registered with element",e,this):(this.isVisible&&this._visibleStates[s].unsubscribe(e),this._visibleStates.splice(s,1),this._visibleSubscribers.splice(s,1))}return}if(this._connectSubscribers){let s=this._connectSubscribers.indexOf(e);s===-1?console.warn("Function not registered with element",e,this):(this.isVisible&&this._connectStates[s].unsubscribe(e),this._connectStates.splice(s,1),this._connectSubscribers.splice(s,1))}}attachStateToProp(e,t,s){this._propStates||(this._propStates={}),this.dettachStateFromProp(e),this._propStates[e]=[this.attachState(t,n=>{this[e]=n},s),Boolean(s)]}dettachStateFromProp(e){this._propStates&&e in this._propStates&&this.dettachState(...this._propStates[e])}set access(e){switch(this._access=e,e){case o.write:this.inert=!1;break;case o.read:this.inert=!0;break;case o.none:this.setAttribute("inert","none");break}}get access(){var e;return(e=this._access)!=null?e:o.write}}const H=new Set(["annotation-xml","color-profile","font-face","font-face-src","font-face-uri","font-face-format","font-face-name","missing-glyph"]);var N=/^[a-z](?:[\.0-9_a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*-(?:[\x2D\.0-9_a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*$/;let B=i=>i?/[A-Z]/.test(i)?"Custom element names must not contain uppercase ASCII characters.":i.includes("-")?/^\d/i.test(i)?"Custom element names must not start with a digit.":/^-/i.test(i)?"Custom element names must not start with a hyphen.":N.test(i)?H.has(i)?`The supplied element name is reserved and can't be used.
See: https://html.spec.whatwg.org/multipage/scripting.html#valid-custom-element-name`:"Unknown fault":"Invalid element name.":"Custom element names must contain a hyphen. Example: unicorn-cake":"Missing element name.",S=i=>{let e=i.elementNameSpace(),t=i.elementName,s="",n=i;for(;n!==HTMLElement&&e===n.elementNameSpace();){let r=n.elementName();if(n=Object.getPrototypeOf(n),t===n.elementName)throw new Error("Element uses same name as ancestor, abstract classes should return '@abstract@'");if(!r.length)throw new Error("Element doesn't define element name");r!=="@abstract@"&&(s="-"+r+s)}s=e+s;try{customElements.define(s,i)}catch(r){throw r.message.includes("has already been used with this registry")?r:new Error(B(s)+" "+s)}};class M extends IntersectionObserver{constructor(e){super(t=>{for(let s=0;s<t.length;s++)t[s].target._setVisible(t[s].isIntersecting)},e)}}class d extends v{constructor(e){super(),this.number=0,this.connects=0,this.disconnects=0,this.visible=0,this.invisible=0,this.style.height="2rem",this.events.on("connect",t=>{switch(t.data){case b.Connect:this.connects++,console.log("con1");break;case b.Disconnect:this.disconnects++,console.log("con2");break}this.render()}),this.events.on("visible",t=>{t.data?(this.visible++,console.log("vis1")):(this.invisible++,console.log("vis2")),this.render()})}static elementName(){return"testclass"}options(e){return this}render(){this.innerHTML=`Test Element ${this.number} Connects:${this.connects} Disconnects${this.disconnects} Visible:${this.visible} Invisible${this.invisible}`,this.style.backgroundColor=`rgb(${Number(!this.isVisible)*255},${Number(this.isVisible)*255},0)`}}S(d);class g extends v{constructor(){super()}static elementName(){return"testclass2"}}S(g);let F=new g;document.body.appendChild(F);let w=new p("Testing Attention Please");F.attachStateToProp("innerHTML",w);setTimeout(()=>{w.set("Testing something else")},2e3);let m=document.body.appendChild(document.createElement("div")),V=m.appendChild(document.createElement("div"));V.innerHTML="Test Connecting";let C=m.appendChild(document.createElement("button"));C.innerHTML="Toggle Connect";C.onclick=()=>{l.children.length===0?f.forEach(i=>{l.appendChild(i)}):l.replaceChildren()};let l=m.appendChild(document.createElement("div"));l.style.display="flex";l.style.flexDirection="column";let f=[];for(let i=0;i<=19;i++){let e=new d(String(i));l.appendChild(e),f[i]=e}let P=new p(o.write);f[0].attachStateToProp("access",P);let h=document.body.appendChild(document.createElement("div")),$=h.appendChild(document.createElement("div"));$.innerHTML="Test Observer";let T=h.appendChild(document.createElement("button"));T.innerHTML="Toggle Observer";let u=!0;T.onclick=()=>{_.forEach(i=>{i.attachToObserver(u?void 0:y)}),u=!u};let x=h.appendChild(document.createElement("button"));x.innerHTML="Toggle Connect";x.onclick=()=>{a.children.length===0?_.forEach(i=>{a.appendChild(i)}):a.replaceChildren()};let a=h.appendChild(document.createElement("div"));a.style.display="flex";a.style.flexDirection="column";let y=new M({threshold:.9}),_=[];for(let i=0;i<=99;i++){let e=new d(String(i));e.attachToObserver(y),a.appendChild(e),_[i]=e}
